# Задания по управлению правами доступа в Linux

## Работа в Docker контейнере

Выполнение заданий в Docker контейнере с Ubuntu:
```bash
docker run --rm -it ubuntu /bin/bash
```

**Важно:** В Docker контейнере вы работаете под пользователем `root` по умолчанию, поэтому команды `sudo` могут не понадобиться. Для демонстрации ограничений доступа создайте обычного пользователя:

```bash
# Создаем пользователя для демонстрации (в Ubuntu контейнере используйте useradd)
useradd -m testuser

# Устанавливаем пароль для пользователя (или используйте su - testuser)
passwd testuser
# Введите пароль дважды (например: test123)

# Переключаемся на него
su - testuser
```

## 1. Папка с ограниченными правами для обычных пользователей

Создайте папку, в которой только ваш пользователь сможет создавать и удалять файлы, а остальные пользователи — только просматривать список файлов.

```bash
# Создаем папку
mkdir restricted_folder

# Устанавливаем права: владелец - полный доступ, группа и остальные - только чтение
chmod 755 restricted_folder

# Проверяем права
ls -ld restricted_folder
```

## 2. Темный каталог (скрытый)

Создайте темный каталог. Покажите, что получить список файлов нельзя, но можно получить доступ к файлу, зная его имя.

```bash
# 1. Запуск контейнера
docker run --rm -it ubuntu /bin/bash

# 2. Установка утилит
apt update -y > /dev/null 2>&1
apt install -y coreutils > /dev/null 2>&1

# 3. Создание каталогов и файлов
mkdir -p /demo/{normal,dark,private}

echo "secret normal" > /demo/normal/secret.txt
echo "secret dark"   > /demo/dark/secret.txt
echo "secret private" > /demo/private/secret.txt

# 4. Установка владельца и прав
chown -R root:root /demo
chmod 755 /demo/normal
chmod 644 /demo/normal/*
chmod 711 /demo/dark
chmod 644 /demo/dark/*
chmod 700 /demo/private
chmod 600 /demo/private/*

# 5. Создание обычного пользователя
useradd -m -s /bin/bash demo
echo "demo:demo123" | chpasswd
cp -r /demo /home/demo/
chown -R root:root /home/demo/demo

# 6. Проверка от имени demo
su - demo
# normal (755)
ls /home/demo/demo/normal 2>&1 || echo 'Permission denied'
cat /home/demo/demo/normal/secret.txt 2>&1 || echo 'Permission denied'

# dark (711)
ls /home/demo/demo/dark 2>&1 || echo 'Permission denied'
cat /home/demo/demo/dark/secret.txt 2>&1 || echo 'Permission denied'

# private (700)
ls /home/demo/demo/private 2>&1 || echo 'Permission denied'
cat /home/demo/demo/private/secret.txt 2>&1 || echo 'Permission denied'
```

## 3. Папка только для суперпользователя на запись

Создайте папку, доступ на запись в которую есть только у суперпользователя, а доступ на чтение — у всех. Попробуйте создать в ней файл. Теперь попробуйте создать файл с правами суперпользователя (использовав команду sudo).

```bash
# Создаем папку
mkdir admin_only_folder

# Устанавливаем права: владелец - полный доступ, остальные - только чтение
chmod 755 admin_only_folder

# Пробуем создать файл обычным пользователем (должно не получиться)
# Сначала переключитесь на обычного пользователя: su testuser
touch admin_only_folder/test.txt

# Создаем файл с правами суперпользователя (в Docker вы уже root)
# Вернитесь к root: exit
touch admin_only_folder/admin_file.txt

# Проверяем результат
ls -la admin_only_folder/
```

## 4. Файл только для суперпользователя на редактирование

Создайте файл, отредактировать который сможет только суперпользователь, а прочитать — любой.

```bash
# Создаем файл (в Docker вы уже root)
touch superuser_file.txt

# Устанавливаем права: владелец - полный доступ, остальные - только чтение
chmod 644 superuser_file.txt

# Пробуем редактировать обычным пользователем (должно не получиться)
# Переключитесь на обычного пользователя: su testuser
echo "Попытка записи" >> superuser_file.txt

# Редактируем с правами суперпользователя
# Вернитесь к root: exit
echo "Запись от суперпользователя" >> superuser_file.txt

# Проверяем содержимое
cat superuser_file.txt
```

## 5. Файл с полным доступом для всех

Создайте файл, полный доступ к которому имеет любой пользователь в системе.

```bash
# Создаем файл
touch public_file.txt

# Устанавливаем права: полный доступ для всех
chmod 777 public_file.txt

# Проверяем права
ls -l public_file.txt

# Проверяем доступ на чтение
cat public_file.txt

# Проверяем доступ на запись
echo "Тест записи" > public_file.txt
```

---

## Объяснение прав доступа

- **755**: владелец - чтение/запись/выполнение, группа и остальные - чтение/выполнение
- **700**: только владелец имеет полный доступ
- **644**: владелец - чтение/запись, группа и остальные - только чтение
- **777**: полный доступ для всех пользователей

## Команды для скриншотов

Для каждого задания делайте скриншот результата команды:

```bash
ls -la restricted_folder/
ls -la .hidden_folder/
ls -la admin_only_folder/
ls -l superuser_file.txt
ls -l public_file.txt
```

## Порядок выполнения в Docker

1. **Запустите Docker контейнер:**
   ```bash
   docker run --rm -it ubuntu /bin/bash
   ```

2. **Создайте пользователя для демонстрации:**
   ```bash
   useradd -m testuser
   passwd testuser
   # Введите пароль дважды (например: test123)
   ```

3. **Выполните задания по порядку:**
   - Задание 1: Создайте папку с ограниченными правами
   - Задание 2: Создайте скрытую папку
   - Задание 3: Создайте папку для суперпользователя (используйте `su testuser` для демонстрации ограничений)
   - Задание 4: Создайте файл для суперпользователя (используйте `su testuser` для демонстрации ограничений)
   - Задание 5: Создайте файл с полным доступом

4. **Для каждого задания сделайте скриншот:**
   - Покажите результат команд `ls -la` и `ls -l`
   - Продемонстрируйте работу прав доступа
   - Покажите ошибки доступа при работе под обычным пользователем

**Полезные команды для навигации:**
```bash
# Переключение между пользователями
su - testuser  # переключиться на обычного пользователя (с полной сменой окружения)
exit           # вернуться к root

# Просмотр текущего пользователя
whoami

# Просмотр прав доступа
ls -la
```
